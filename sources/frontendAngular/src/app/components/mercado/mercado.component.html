<div class="container-fluid py-4">
  <div class="row mb-4">
    <div class="col">
      <div class="d-flex justify-content-between align-items-center">
        <h2 class="mb-0">
          <i class="bi bi-graph-up text-primary me-2"></i>
          Mercado de Activos
        </h2>
        <div class="d-flex align-items-center" *ngIf="usuario">
          <span class="badge bg-success me-3">
            <i class="bi bi-wallet2 me-1"></i>
            {{ formatearDinero(usuario.balance) }}
          </span>
          <span class="badge bg-info me-2">{{ usuario.nombre }}</span>
        </div>
      </div>
      <p class="text-muted mt-2">
        <i class="bi bi-clock-history me-1"></i>
        Los precios se actualizan cada 10 segundos
      </p>
    </div>
  </div>

  <div class="row" *ngIf="!(activos$ | async)">
    <div class="col text-center py-5">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Cargando...</span>
      </div>
      <p class="mt-3 text-muted">Cargando activos...</p>
    </div>
  </div>

  <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4" *ngIf="activos$ | async as activos">
    <div class="col" *ngFor="let activo of activos">
      <div class="card h-100 shadow-sm">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-start mb-3">
            <h5 class="card-title mb-0">{{ activo.nombre }}</h5>
            <span class="badge" [ngClass]="{
              'bg-success': activo.variacion && activo.variacion > 0,
              'bg-danger': activo.variacion && activo.variacion < 0,
              'bg-secondary': !activo.variacion || activo.variacion === 0
            }">
              <i class="bi" [ngClass]="{
                'bi-arrow-up': activo.tendencia === 'alza',
                'bi-arrow-down': activo.tendencia === 'baja',
                'bi-arrow-right': !activo.tendencia || activo.tendencia === 'estable'
              }"></i>
              {{ activo.variacion ? (activo.variacion > 0 ? '+' : '') + activo.variacion + '%' : '0%' }}
            </span>
          </div>
          
          <h6 class="card-subtitle mb-3 text-muted">{{ activo.simbolo }}</h6>
          
          <div class="d-flex justify-content-between align-items-center mb-3">
            <span class="h4 mb-0">{{ formatearDinero(activo.precio || activo.ultimo_precio) }}</span>
          </div>

          <div class="d-grid gap-2" *ngIf="usuario">
            <button class="btn btn-primary" (click)="abrirDialogoTransaccion(activo, 'compra')">
              <i class="bi bi-cart-plus me-2"></i>Comprar
            </button>
            <button class="btn btn-outline-danger" (click)="abrirDialogoTransaccion(activo, 'venta')">
              <i class="bi bi-cart-dash me-2"></i>Vender
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>